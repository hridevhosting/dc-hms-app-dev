import{a as de,b as me,c as re}from"./chunk-YXE53BZZ.js";import{a as Ie,b as Ee}from"./chunk-T7M7Z6SU.js";import{a as Be}from"./chunk-EXF3M4J6.js";import{a as De}from"./chunk-XFGMMR5A.js";import{A as oe,C as we,K as ae,a as ye,c as Ce,g as ve,s as Se,t as V,v as k,z as le}from"./chunk-A34WLQ27.js";import{b as O,d as j,e as H,g as te,h as ie,i as ne,l as G}from"./chunk-OCIRHO6A.js";import{a as ee,c as U}from"./chunk-6XXP7TRA.js";import{e as be}from"./chunk-3RSPD7AX.js";import{m as X,n as z,q as $,r as xe,t as F}from"./chunk-N4ANQEKW.js";import{Db as C,Eb as c,Hb as L,Lb as he,Ma as o,Mb as ue,Na as I,Nb as fe,Ob as P,Pb as l,Qb as _,Rb as D,Ub as f,Vb as x,Wb as b,Xb as K,Ya as N,Yb as Y,ca as m,cb as y,da as p,fc as S,gc as w,hc as W,nb as g,qb as A,tb as i,ub as n,vb as v,wb as R,xb as T,zb as B}from"./chunk-ZPID5U3R.js";var Pe=(()=>{class s{constructor(e,r){this._dialogConfig=e,this._commonServices=r,this.listDetail=new De("")}ngOnInit(){let e=this._dialogConfig.data||null;this.listDetail.ListItem="",console.log(e),e&&(this.listDetail.ListType=e.listType)}saveListDetail(){this.listDetail.ListType?this._commonServices.saveListByListType(this.listDetail).subscribe(e=>{console.log("saveListByListType",e),e.Status.toLowerCase().includes("success")&&e.Data},e=>{console.error("saveListByListType",e),alert("Please check log, for more detail.")}):alert("Did`nt get List Type, Please try again.")}static{this.\u0275fac=function(r){return new(r||s)(I(V),I(U))}}static{this.\u0275cmp=N({type:s,selectors:[["app-common-list-item"]],decls:9,vars:1,consts:[[1,"d-flex","flex-column",2,"min-width","30rem"],[1,"d-flex","flex-column"],["for",""],["type","text",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-end","mt-2"],["type","button",1,"btn","btn-success"]],template:function(r,t){r&1&&(i(0,"div",0)(1,"div",1)(2,"label",2)(3,"strong"),l(4,"Name"),n()(),i(5,"input",3),b("ngModelChange",function(h){return x(t.listDetail.ListItem,h)||(t.listDetail.ListItem=h),h}),n()(),i(6,"div",4)(7,"button",5),l(8," Save "),n()()()),r&2&&(o(5),f("ngModel",t.listDetail.ListItem))},dependencies:[F,G,O,j,H],encapsulation:2})}}return s})();var se=class{constructor(){this.BillReceiptId=0,this.BillNo=0,this.TranDate="",this.TranDesc="",this.Receipts=0,this.TDSAmount=0,this.PaymentMode="",this.Amount=0,this.ChequeDate="",this.IssuerBank="",this.ChequeNo="",this.EntryBy="",this.EntryAt="",this.Active=0,this.IsSync=0,this.Payer="",this.TPA="",this.ReceiptNo="",this.Locked=null,this.Printed=null,this.LockedBy=null,this.LockedAt=null,this.change_Remark=null,this.updatedAt="",this.PATHLABID=null,this.BillDepartment=null,this.R_Department="",this.R_WhichOpd="",this.oldsoft=null,this.oldEncounterid=null}};var We=()=>({width:"auto"});function Fe(s,d){if(s&1&&(i(0,"option",35),l(1),S(2,"uppercase"),n()),s&2){let e=d.$implicit;L("value",e),o(),_(w(2,2,e))}}function Ue(s,d){if(s&1&&(i(0,"option",35),l(1),S(2,"uppercase"),n()),s&2){let e=d.$implicit;L("value",e),o(),_(w(2,2,e))}}function Oe(s,d){if(s&1&&(i(0,"option",35),l(1),S(2,"uppercase"),n()),s&2){let e=d.$implicit;L("value",e),o(),D("",w(2,2,e)," ")}}function je(s,d){if(s&1){let e=B();R(0),i(1,"div",3)(2,"div",4)(3,"div",5)(4,"label",6)(5,"strong",7),l(6,"Payer"),n(),i(7,"strong",8),C("click",function(){m(e);let t=c();return p(t.showCommonListDialogeBox("Payer"))}),l(8,"Add"),n()(),i(9,"select",9),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.Payer,t)||(a.billReceiptDetail.Payer=t),p(t)}),i(10,"option",10),l(11,"Select Payer..."),n(),y(12,Fe,3,4,"option",11),n()(),i(13,"div",5)(14,"label",6)(15,"strong",7),l(16,"TPA"),n(),i(17,"strong",8),C("click",function(){m(e);let t=c();return p(t.showCommonListDialogeBox("Tpa"))}),l(18,"Add"),n()(),i(19,"select",9),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.TPA,t)||(a.billReceiptDetail.TPA=t),p(t)}),i(20,"option",10),l(21,"Select TPA..."),n(),y(22,Ue,3,4,"option",11),n()()(),i(23,"div",4)(24,"div",12)(25,"label",13)(26,"strong",7),l(27,"Transaction Date"),n()(),i(28,"input",14),C("change",function(){m(e);let t=c();return p(t.onChangeShowDetail())}),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.TranDate,t)||(a.billReceiptDetail.TranDate=t),p(t)}),n()(),i(29,"div",12)(30,"label",6)(31,"strong",7),l(32,"Payment Mode"),n(),i(33,"strong",8),C("click",function(){m(e);let t=c();return p(t.showCommonListDialogeBox("PaymentMode"))}),l(34,"Add"),n()(),i(35,"select",9),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.PaymentMode,t)||(a.billReceiptDetail.PaymentMode=t),p(t)}),i(36,"option",10),l(37,"Select Mode..."),n(),y(38,Oe,3,4,"option",11),n()()(),i(39,"div",15)(40,"div",16)(41,"label",13)(42,"strong",7),l(43,"Description"),n()(),i(44,"textarea",17),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.TranDesc,t)||(a.billReceiptDetail.TranDesc=t),p(t)}),n()(),i(45,"div",18)(46,"div",19)(47,"label",13)(48,"strong",20),l(49,"Receipt Amount"),n()(),i(50,"input",21),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.Receipts,t)||(a.billReceiptDetail.Receipts=t),p(t)}),n()(),i(51,"div",19)(52,"label",6)(53,"strong",7),l(54,"Charges List"),n()(),i(55,"button",22),C("click",function(){m(e);let t=c();return p(t.showChargesList=!t.showChargesList)}),l(56," Show Charges "),n()()()(),v(57,"hr"),i(58,"div",23)(59,"div",5)(60,"label",13)(61,"strong",7),l(62,"TDS Deduction"),n()(),i(63,"input",24),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.TDSAmount,t)||(a.billReceiptDetail.TDSAmount=t),p(t)}),n()(),i(64,"div",5)(65,"label",13)(66,"strong",7),l(67,"Cheque No"),n()(),i(68,"input",25),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.ChequeNo,t)||(a.billReceiptDetail.ChequeNo=t),p(t)}),n()()(),i(69,"div",26)(70,"div",27)(71,"label",6)(72,"strong",7),l(73,"Bank"),n(),i(74,"strong",28),l(75,"Add"),n()(),i(76,"select",9),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.IssuerBank,t)||(a.billReceiptDetail.IssuerBank=t),p(t)}),i(77,"option",10),l(78,"Select TPA..."),n(),v(79,"option",10),n()(),i(80,"div",29)(81,"label",13)(82,"strong",7),l(83,"Payment Date"),n()(),i(84,"input",30),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.ChequeDate,t)||(a.billReceiptDetail.ChequeDate=t),p(t)}),n()(),i(85,"div",31)(86,"div",32)(87,"button",33),l(88,"Print"),n(),i(89,"button",34),C("click",function(){m(e);let t=c();return p(t.saveReceiptDetailByBillNo())}),l(90,"Save Receipt"),n()()()()(),T()}if(s&2){let e=c();o(9),f("ngModel",e.billReceiptDetail.Payer),o(3),g("ngForOf",e.payerList),o(7),f("ngModel",e.billReceiptDetail.TPA),o(3),g("ngForOf",e.tpaList),o(6),f("ngModel",e.billReceiptDetail.TranDate),o(7),f("ngModel",e.billReceiptDetail.PaymentMode),o(3),g("ngForOf",e.paymentModeList),o(6),f("ngModel",e.billReceiptDetail.TranDesc),o(6),f("ngModel",e.billReceiptDetail.Receipts),o(5),g("disabled",!e.billItemList.length),o(8),f("ngModel",e.billReceiptDetail.TDSAmount),o(5),f("ngModel",e.billReceiptDetail.ChequeNo),o(8),f("ngModel",e.billReceiptDetail.IssuerBank),o(8),f("ngModel",e.billReceiptDetail.ChequeDate)}}function He(s,d){if(s&1&&(i(0,"option",35),l(1),S(2,"uppercase"),n()),s&2){let e=d.$implicit;L("value",e),o(),_(w(2,2,e))}}function Ge(s,d){if(s&1&&(i(0,"option",35),l(1),S(2,"uppercase"),n()),s&2){let e=d.$implicit;L("value",e),o(),_(w(2,2,e))}}function qe(s,d){if(s&1&&(i(0,"option",35),l(1),S(2,"uppercase"),n()),s&2){let e=d.$implicit;L("value",e),o(),D("",w(2,2,e)," ")}}function Qe(s,d){if(s&1){let e=B();R(0),i(1,"div",3)(2,"div",36)(3,"div",37)(4,"label",6)(5,"strong",7),l(6,"Payer"),n(),i(7,"strong",8),C("click",function(){m(e);let t=c();return p(t.showCommonListDialogeBox("Payer"))}),l(8,"Add"),n()(),i(9,"select",9),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.Payer,t)||(a.billReceiptDetail.Payer=t),p(t)}),i(10,"option",10),l(11,"Select Payer..."),n(),y(12,He,3,4,"option",11),n()(),i(13,"div",37)(14,"label",6)(15,"strong",7),l(16,"TPA"),n(),i(17,"strong",8),C("click",function(){m(e);let t=c();return p(t.showCommonListDialogeBox("Tpa"))}),l(18,"Add"),n()(),i(19,"select",9),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.TPA,t)||(a.billReceiptDetail.TPA=t),p(t)}),i(20,"option",10),l(21,"Select TPA..."),n(),y(22,Ge,3,4,"option",11),n()()(),i(23,"div",36)(24,"div",38)(25,"label",13)(26,"strong",7),l(27,"Transaction Date"),n()(),i(28,"input",14),C("change",function(){m(e);let t=c();return p(t.onChangeShowDetail())}),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.TranDate,t)||(a.billReceiptDetail.TranDate=t),p(t)}),n()(),i(29,"div",38)(30,"label",6)(31,"strong",7),l(32,"Payment Mode"),n(),i(33,"strong",8),C("click",function(){m(e);let t=c();return p(t.showCommonListDialogeBox("PaymentMode"))}),l(34,"Add"),n()(),i(35,"select",9),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.PaymentMode,t)||(a.billReceiptDetail.PaymentMode=t),p(t)}),i(36,"option",10),l(37,"Select Mode..."),n(),y(38,qe,3,4,"option",11),n()()(),i(39,"div",39)(40,"label",13)(41,"strong",7),l(42,"Description"),n()(),i(43,"textarea",40),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.TranDesc,t)||(a.billReceiptDetail.TranDesc=t),p(t)}),n()(),i(44,"div",41)(45,"div",37)(46,"label",13)(47,"strong",20),l(48,"Receipt Amount"),n()(),i(49,"input",21),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.Receipts,t)||(a.billReceiptDetail.Receipts=t),p(t)}),n()(),i(50,"div",37)(51,"label",6)(52,"strong",7),l(53,"Charges List"),n()(),i(54,"button",22),C("click",function(){m(e);let t=c();return p(t.showChargesList=!t.showChargesList)}),l(55," Show Charges "),n()()(),v(56,"hr"),i(57,"div",42)(58,"div",37)(59,"label",13)(60,"strong",7),l(61,"TDS Deduction"),n()(),i(62,"input",24),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.TDSAmount,t)||(a.billReceiptDetail.TDSAmount=t),p(t)}),n()(),i(63,"div",37)(64,"label",13)(65,"strong",7),l(66,"Cheque No"),n()(),i(67,"input",25),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.ChequeNo,t)||(a.billReceiptDetail.ChequeNo=t),p(t)}),n()()(),i(68,"div",43)(69,"div",19)(70,"label",6)(71,"strong",7),l(72,"Bank"),n(),i(73,"strong",28),l(74,"Add"),n()(),i(75,"select",9),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.IssuerBank,t)||(a.billReceiptDetail.IssuerBank=t),p(t)}),i(76,"option",10),l(77,"Select TPA..."),n(),v(78,"option",10),n()(),i(79,"div",19)(80,"label",13)(81,"strong",7),l(82,"Payment Date"),n()(),i(83,"input",30),b("ngModelChange",function(t){m(e);let a=c();return x(a.billReceiptDetail.ChequeDate,t)||(a.billReceiptDetail.ChequeDate=t),p(t)}),n()(),i(84,"div",44)(85,"div",32)(86,"button",33),l(87,"Print"),n(),i(88,"button",45),l(89,"Save Receipt"),n()()()()(),T()}if(s&2){let e=c();o(9),f("ngModel",e.billReceiptDetail.Payer),o(3),g("ngForOf",e.payerList),o(7),f("ngModel",e.billReceiptDetail.TPA),o(3),g("ngForOf",e.tpaList),o(6),f("ngModel",e.billReceiptDetail.TranDate),o(7),f("ngModel",e.billReceiptDetail.PaymentMode),o(3),g("ngForOf",e.paymentModeList),o(5),f("ngModel",e.billReceiptDetail.TranDesc),o(6),f("ngModel",e.billReceiptDetail.Receipts),o(5),g("disabled",!e.billItemList.length),o(8),f("ngModel",e.billReceiptDetail.TDSAmount),o(5),f("ngModel",e.billReceiptDetail.ChequeNo),o(8),f("ngModel",e.billReceiptDetail.IssuerBank),o(8),f("ngModel",e.billReceiptDetail.ChequeDate)}}function Ye(s,d){if(s&1){let e=B();i(0,"tr")(1,"td",49)(2,"div",50)(3,"div",51)(4,"input",52,0),C("click",function(){m(e);let t=P(5),a=c().$implicit,h=c(2);return p(h.addDeleteCharges(a,t.checked))}),n()()()(),i(6,"td"),l(7),S(8,"uppercase"),n(),i(9,"td",47),l(10),n(),i(11,"td",47),l(12),n(),i(13,"td",47),l(14),n(),i(15,"td",53),l(16),n()()}if(s&2){let e=c(),r=e.$implicit,t=e.index,a=c(2);o(4),g("disabled",a.checkPaidUnpaid("bill_item_receipt_paidUnpaid_"+t)),o(3),_(w(8,9,r.HeadDesc)),o(3),_(r.Rate),o(2),_(r.Unit),o(2),_(r.Amount),o(),A(a.changeBgColorByPaidUnPaid("bill_item_receipt_paidUnpaid_"+t)),g("id","bill_item_receipt_paidUnpaid_"+t),o(),D(" ",a.checkPaidUnPaid(r)," ")}}function Ze(s,d){if(s&1&&(R(0),y(1,Ye,17,11,"tr",1),T()),s&2){let e=d.$implicit;o(),g("ngIf",e.Code)}}function Je(s,d){if(s&1&&(R(0),i(1,"table",46)(2,"thead")(3,"tr")(4,"th",47),l(5,"#"),n(),i(6,"th"),l(7,"Charges Name"),n(),i(8,"th",47),l(9,"Rate"),n(),i(10,"th",47),l(11,"Unit"),n(),i(12,"th",47),l(13,"Cost"),n(),i(14,"th",47),l(15,"Paid/Unpaid"),n()()(),i(16,"tbody"),y(17,Ze,2,1,"ng-container",48),n()(),T()),s&2){let e=c();o(17),g("ngForOf",e.billItemList)}}function Ke(s,d){if(s&1){let e=B();i(0,"div",60)(1,"small")(2,"div",61)(3,"div",62)(4,"strong"),l(5),n()(),i(6,"div",63)(7,"div",64)(8,"strong")(9,"i"),l(10),S(11,"uppercase"),n()()(),i(12,"div",65)(13,"strong")(14,"span",56),l(15,"R:"),n(),l(16),n(),i(17,"strong")(18,"span",57),l(19,"U:"),n(),l(20),n(),i(21,"strong")(22,"span",58),l(23,"C:"),n(),l(24),n(),i(25,"strong",66)(26,"i"),l(27),n()()()(),i(28,"div",67)(29,"div",51)(30,"input",52,0),C("click",function(){let t=m(e).$implicit,a=P(31),h=c(2);return p(h.addDeleteCharges(t,a.checked))}),n()()()()()()}if(s&2){let e=d.$implicit,r=d.index,t=c(2);o(5),_(r+1),o(5),_(w(11,10,e.HeadDesc)),o(6),D(" ",e.Rate,""),o(4),D(" ",e.Unit,""),o(4),D(" ",e.Amount,""),o(),A(t.changeBgColorByPaidUnPaid("bill_item_receipt_paidUnpaid_"+r)),g("id","bill_item_receipt_paidUnpaid_"+r),o(2),_(t.checkPaidUnPaid(e)),o(3),g("disabled",t.checkPaidUnpaid("bill_item_receipt_paidUnpaid_"+r))}}function Xe(s,d){if(s&1&&(R(0),i(1,"small",54)(2,"div",55)(3,"strong")(4,"span",56),l(5,"R - "),n(),l(6," Rate"),n(),i(7,"strong")(8,"span",57),l(9,"U - "),n(),l(10," Unit"),n(),i(11,"strong")(12,"span",58),l(13,"C - "),n(),l(14," Cost"),n()()(),y(15,Ke,32,12,"div",59),T()),s&2){let e=c();o(15),g("ngForOf",e.billItemList)}}var Ae=(()=>{class s{constructor(e,r,t,a){this._dialogService=e,this._commonServices=r,this._dialogeConfig=t,this._billManagementServices=a,this.billReceiptDetail=new se,this.billType="",this.payerList=[],this.tpaList=[],this.paymentModeList=[],this.billItemList=[],this.receiptList=[],this.patientGivenAmount=0,this.showChargesList=!1,this.paidItemList=[],this.recentReceiptNo=""}ngOnInit(){this.billReceiptDetail.TranDate=this._commonServices.trasformDateTimeByFormat("yyyy-MM-dd")||"",this.billReceiptDetail.ChequeDate=this._commonServices.trasformDateTimeByFormat("yyyy-MM-dd")||"",console.log(this.billReceiptDetail);let e=this._dialogeConfig.data||null;console.log(e),e&&(this.billReceiptDetail.BillNo=e.billNo||"",this.billType=e.billType||"",this.loadBillItemDetailList(),this.loadRecentReceiptNo()),this.loadPayerList(),this.loadTpaList(),this.loadPaymentModeList()}showCommonListDialogeBox(e){let r=this._dialogService.open(Pe,{header:e.toUpperCase(),width:"auto",position:"bottom",data:{listType:e,isNew:!0,listData:null}})}loadPayerList(){this._commonServices.getPayerList().subscribe(e=>{e.Status.toLowerCase().includes("success")&&e.noofREcords&&(this.payerList=[],e.dataSet.Table.forEach(r=>{r.ListItem&&this.payerList.push(r.ListItem)}))},e=>{console.error(e),alert("Please check log, for more detail.")})}loadTpaList(){this._commonServices.getTpaList().subscribe(e=>{e.Status.toLowerCase().includes("success")&&e.noofREcords&&(this.tpaList=[],e.dataSet.Table.forEach(r=>{r.ListItem&&this.tpaList.push(r.ListItem)}))},e=>{console.error(e),alert("Please check log, for more detail.")})}loadPaymentModeList(){this._commonServices.getPaymentModeList().subscribe(e=>{e.Status.toLowerCase().includes("success")&&e.noofREcords&&(this.paymentModeList=[],e.dataSet.Table.forEach(r=>{r.ListItem&&this.paymentModeList.push(r.ListItem)}))},e=>{console.error(e),alert("Please check log, for more detail.")})}saveBillReceiptDetail(){this._billManagementServices.saveReceiptDetail(this.billReceiptDetail).subscribe(e=>{console.log(e),e.Status.toLowerCase().includes("success")&&e.Data},e=>{console.error(e),alert("Please check log, for more detail.")})}onChangeShowDetail(){console.log(this.billReceiptDetail)}loadBillItemDetailList(){this._billManagementServices.getBillItemDetailsByBillNo(Number(this.billReceiptDetail.BillNo)).subscribe(e=>{console.log(e),e.Status.toLowerCase().includes("success")&&e.noofREcords&&(this.billItemList=e.dataSet.Table,console.log("billItemList",this.billItemList),this.loadReceiptListByBillId())},e=>{console.error(e),alert("Please check log, for more detail.")})}loadReceiptListByBillId(){this._billManagementServices.getRecieptListByBillId(this.billReceiptDetail.BillNo).subscribe(e=>{console.log("getRecieptListByBillId =>",e),e.Status.toLowerCase().includes("success")&&e.noofREcords&&(this.receiptList=[],this.receiptList=e.dataSet.Table),this.calculatePatientGiven()},e=>{console.error("getRecieptListByBillId =>",e),alert("Please check log, for more details")})}calculatePatientGiven(){this.patientGivenAmount=0,this.receiptList.length&&(this.receiptList.forEach(e=>{this.patientGivenAmount=e.Receipts+this.patientGivenAmount}),this.sortPaidUnPaid())}addDeleteCharges(e,r){if(r)this.billReceiptDetail.TranDesc?this.billReceiptDetail.TranDesc.toLowerCase().includes(e.HeadDesc.toLowerCase())||(this.billReceiptDetail.TranDesc.trim()[this.billReceiptDetail.TranDesc.trim().length-1].includes(",")||(this.billReceiptDetail.TranDesc=this.billReceiptDetail.TranDesc+", "+e.HeadDesc,this.billReceiptDetail.Receipts=this.billReceiptDetail.Receipts+e.Amount),this.billReceiptDetail.TranDesc.trim()[this.billReceiptDetail.TranDesc.trim().length-1].includes(",")&&(this.billReceiptDetail.TranDesc=this.billReceiptDetail.TranDesc+e.HeadDesc,this.billReceiptDetail.Receipts=this.billReceiptDetail.Receipts+e.Amount)):(this.billReceiptDetail.TranDesc=e.HeadDesc,this.billReceiptDetail.Receipts=this.billReceiptDetail.Receipts+e.Amount);else if(this.billReceiptDetail.TranDesc.toLowerCase().includes(e.HeadDesc.toLowerCase())){let t=this.billReceiptDetail.TranDesc.split(",");if(t.length){for(let a=0;a<t.length;a++)t[a].toLowerCase().includes(e.HeadDesc.toLowerCase())&&(t[a]="",this.billReceiptDetail.Receipts=this.billReceiptDetail.Receipts-e.Amount);this.billReceiptDetail.TranDesc="";for(let a=0;a<t.length;a++)t[a]&&(this.billReceiptDetail.TranDesc=this.billReceiptDetail.TranDesc+(this.billReceiptDetail.TranDesc?",":"")+t[a])}}}sortPaidUnPaid(){let e=0;e=this.patientGivenAmount;let r=!1;if(this.receiptList.length){for(let t=0;t<this.billItemList.length;t++){let a={isPaid:0,balanceAmount:0,data:null};this.billItemList[t].Amount&&!this.billItemList[t].Code&&(e=r?0:e-this.billItemList[t].Amount,(e<0||r)&&(a.balanceAmount=r?0:e,a.data=this.billItemList[t],r=!0),e>0&&!r&&(a.isPaid=1,a.data=this.billItemList[t]),e===0&&!r&&(a.isPaid=1,a.data=this.billItemList[t]),this.paidItemList.push(a))}console.log(this.paidItemList)}}checkPaidUnPaid(e){let r="Unpaid";if(this.paidItemList.length)for(let t=0;t<this.paidItemList.length;t++)this.paidItemList[t].isPaid&&this.paidItemList[t].data.BillDetailId===e.BillDetailId&&(r="Paid");return r}changeBgColorByPaidUnPaid(e){let t=document.getElementById(e)?.innerText||"";return t&&t.toLowerCase()==="paid"?"background-color: green; color: white;":"background-color: red; color: white;"}checkPaidUnpaid(e){let t=document.getElementById(e)?.innerText||"";return t?t.toLowerCase()==="paid":!1}saveReceiptDetailByBillNo(){console.log(this.billReceiptDetail),this.billReceiptDetail.BillReceiptId<=0}validPlatform(e){return this._commonServices.checkPlatform(e)}loadRecentReceiptNo(){this._billManagementServices.getRecentReceiptNo(this.billType).subscribe(e=>{console.log(e),e.Status.toLowerCase().includes("success")&&e.noofREcords&&(this.recentReceiptNo=e.dataSet.Table[0].ReceiptNo||"",console.log(this.recentReceiptNo),this.configureNewReceiptNoBasedOnRecentReceiptNo())},e=>{console.error(e)})}configureNewReceiptNoBasedOnRecentReceiptNo(){let e=0,r="";for(let t=0;t<this.recentReceiptNo.length;t++)(this.recentReceiptNo[t]>="0"&&this.recentReceiptNo[t]<="9"||this.recentReceiptNo[t]===".")&&(this.recentReceiptNo[t-1]>="0"&&this.recentReceiptNo[t-1]<="9"&&(this.recentReceiptNo[t+1]<="9"||t===this.recentReceiptNo.length-1)?this.recentReceiptNo[t-1]>="0"&&(this.recentReceiptNo[t+1]<="9"||t===this.recentReceiptNo.length-1)&&(r=r+this.recentReceiptNo[t]):r=r+this.recentReceiptNo[t]);debugger;if(this.billReceiptDetail.BillReceiptId<=0&&!this.billReceiptDetail.ReceiptNo&&r.includes(".")){let t=this._commonServices.trasformDateTimeByFormat("yy"),a=this._commonServices.trasformDateTimeByFormat("MM"),h=r.split("."),u=h[h.length-1].length,Z=Number(h[h.length-1])+1,M="0",ge="",_e="";if(h.length===3&&(h[0]!==t&&(ge=h[0],h[0]=t||h[0]),h[1]!==a&&(_e=h[1],h[1]=a||h[1])),ge||_e)for(let E=0;E<u;E++)E+1===u?M=M+"1":M=M+"0";else for(let E=0;E<u;E++)E===u-Number(Z.toString().length)?(M=M+Z.toString(),M.length===u.toString().length&&(E=u.toString().length)):M=M+"0";if(M=h[0]+"."+h[1]+"."+M,console.log(M),this.recentReceiptNo.includes("/")){let E="",J=this.recentReceiptNo.split("/");for(let Q=0;Q<J.length;Q++)Q+1===J.length?E=E+"/"+M:E=E.length===0?J[Q]:E+"/"+J[Q];console.log(E),this.billReceiptDetail.ReceiptNo=E}}console.log(r)}static{this.\u0275fac=function(r){return new(r||s)(I(k),I(U),I(V),I(re))}}static{this.\u0275cmp=N({type:s,selectors:[["app-bill-receipt"]],features:[K([k])],decls:5,vars:10,consts:[["checkBoxCharges",""],[4,"ngIf"],["header","Charges List","position","bottom",3,"visibleChange","draggable","modal","visible"],[1,"d-flex","flex-column","mt-2"],[1,"d-flex","flex-row","gap-2","w-100"],[1,"d-flex","flex-column","border-2","p-2","w-50"],[1,"d-flex","justify-content-between",2,"margin-top","-22px"],[1,"p-1",2,"background-color","white"],[1,"underline",2,"background-color","white","color","red","cursor","pointer",3,"click"],["name","","id","",1,"form-select","form-select-sm",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"d-flex","flex-column","border-2","p-2","mt-3","w-50"],[2,"margin-top","-22px"],["type","date","name","","id","",1,"form-control","form-control-sm","mt-1",3,"change","ngModelChange","ngModel"],[1,"d-flex","flex-row","gap-1","w-100","mt-3"],[1,"d-flex","flex-column","border-2","p-2",2,"width","50%"],["name","","id","","rows","5","placeholder","Enter description...",1,"form-control","form-control-sm",3,"ngModelChange","ngModel"],[1,"d-flex","flex-column","gap-1",2,"width","50%"],[1,"d-flex","flex-column","border-2","p-2"],[1,"p-1",2,"background-color","white","color","red"],["type","text","name","","id","",1,"form-control","form-control-lg",3,"ngModelChange","ngModel"],["type","button",1,"btn","btn-primary","shadow-lg",3,"click","disabled"],[1,"d-flex","flex-row","gap-2"],["type","text","name","","id","","placeholder","0.00",1,"form-control","form-control-sm",3,"ngModelChange","ngModel"],["type","text","name","","id","","placeholder","Enter id...",1,"form-control","form-control-sm",3,"ngModelChange","ngModel"],[1,"d-flex","flex-row","gap-2","w-100","mt-3"],[1,"d-flex","flex-column","border-2","p-2",2,"width","33.4%"],[1,"underline",2,"background-color","white","color","red","cursor","pointer"],[1,"d-flex","flex-column","border-2","p-2",2,"width","33.3%"],["type","date","name","","id","",1,"form-control","form-control-sm","mt-1",3,"ngModelChange","ngModel"],[1,"d-flex","flex-column","p-2","h-100",2,"width","33.3%"],[1,"d-flex","justify-content-around","align-items-center","h-100"],["type","button","disabled","",1,"btn","btn-lg","btn-warning"],["type","button",1,"btn","btn-lg","btn-success",3,"click"],[3,"value"],[1,"d-flex","flex-column","gap-2","w-100"],[1,"d-flex","flex-column","border-2","p-2","w-100"],[1,"d-flex","flex-column","border-2","p-2","mt-3","w-100"],[1,"d-flex","flex-column","border-2","p-2","mt-3"],["name","","id","","rows","3","placeholder","Enter description...",1,"form-control","form-control-sm",3,"ngModelChange","ngModel"],[1,"d-flex","flex-column","mt-3","gap-2"],[1,"d-flex","flex-column","gap-2"],[1,"d-flex","flex-column","gap-2","w-100","mt-3"],[1,"d-flex","flex-column","p-2","h-100"],["type","button",1,"btn","btn-lg","btn-success"],[1,"table","table-bordered"],[1,"text-center"],[4,"ngFor","ngForOf"],[1,"bg-primary","text-center","justify-content-center"],[1,"d-flex"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"click","disabled"],[1,"text-center",3,"id"],[1,"mb-2"],[1,"d-flex","justify-content-around"],[2,"color","#1F4287"],[2,"color","#FFD700"],[2,"color","#CD1818"],["class","card border-0 rounded-2 shadow-lg mb-2 position-relative",4,"ngFor","ngForOf"],[1,"card","border-0","rounded-2","shadow-lg","mb-2","position-relative"],[1,"d-flex","flex-row"],[1,"d-flex","align-items-center","bg-primary","text-white","p-1",2,"border-top-left-radius","5px","border-bottom-left-radius","5px"],[1,"d-flex","flex-column","pl-1","w-100"],[1,""],[1,"d-flex","justify-content-between","w-100"],[1,"pl-1","pr-1",3,"id"],[1,"d-flex","align-items-center"]],template:function(r,t){r&1&&(y(0,je,91,14,"ng-container",1)(1,Qe,90,14,"ng-container",1),i(2,"p-dialog",2),b("visibleChange",function(h){return x(t.showChargesList,h)||(t.showChargesList=h),h}),y(3,Je,18,1,"ng-container",1)(4,Xe,16,1,"ng-container",1),n()),r&2&&(g("ngIf",t.validPlatform("mac")||t.validPlatform("window")),o(),g("ngIf",t.validPlatform("iphone")||t.validPlatform("ipad")||t.validPlatform("andriod")),o(),A(Y(9,We)),g("draggable",!1)("modal",!0),f("visible",t.showChargesList),o(),g("ngIf",!1),o(),g("ngIf",t.validPlatform("iphone")||t.validPlatform("ipad")||t.validPlatform("andriod")))},dependencies:[F,X,z,$,ae,le,G,ie,ne,O,te,j,H],styles:["[_nghost-%COMP%]  .p-dropdown-items{padding:0!important}[_nghost-%COMP%]  .p-dropdown-item-group:hover{background-color:#1e201e;color:#fff;cursor:pointer;transition:.3s ease-in-out}[_nghost-%COMP%]  .p-dropdown-item-group:hover label{cursor:pointer}[_nghost-%COMP%]  .p-dropdown .p-dropdown-label.p-placeholder{padding:5px!important;width:100%}"]})}}return s})();var ce=class{constructor(){this.BillNo="0",this.Code="0",this.HeadDesc="",this.Date="",this.Rate="0",this.Unit="1",this.Amount="0",this.Notes="",this.SeqNo="0",this.Active="1",this.RateId="0",this.source=""}};var q=class{constructor(){this.ItemCode="",this.Provider="",this.RoomType="",this.ItemDesc="",this.Rate=0,this.RateId=0}};var ze=()=>({width:"25rem"}),$e=()=>({width:"100%"});function et(s,d){if(s&1&&(i(0,"h6")(1,"i"),l(2),n()()),s&2){let e=c(2);o(2),_(e.admissionDetails.RegNo)}}function tt(s,d){if(s&1&&(i(0,"h6")(1,"i"),l(2),n()()),s&2){let e=c(2);o(2),_(e.appointmentDetails.RegNo)}}function it(s,d){if(s&1&&(i(0,"div",21)(1,"div",34)(2,"strong"),l(3,"Patient Name "),n(),v(4,"img",35),n(),i(5,"h6")(6,"i"),l(7),n()()()),s&2){let e=c(2);o(7),_(e.patientDetail.EntityName)}}function nt(s,d){if(s&1&&(i(0,"h6")(1,"i"),l(2),n()()),s&2){let e=c(2);o(2),_(e.admissionDetails.Consultant)}}function lt(s,d){if(s&1&&(i(0,"h6")(1,"i"),l(2),n()()),s&2){let e=c(2);o(2),_(e.appointmentDetails.BookedFor)}}function ot(s,d){if(s&1&&(i(0,"option",67),l(1),S(2,"uppercase"),n()),s&2){let e=d.$implicit;L("value",e.ListItem),o(),_(w(2,2,e.ListItem))}}function at(s,d){if(s&1&&(i(0,"option",67),l(1),S(2,"uppercase"),n()),s&2){let e=d.$implicit;L("value",e.ListItem),o(),_(w(2,2,e.ListItem))}}function rt(s,d){if(s&1){let e=B();i(0,"div",21)(1,"div",34)(2,"strong"),l(3,"Date of Addmission "),n()(),i(4,"input",68),b("ngModelChange",function(t){m(e);let a=c(2);return x(a.admissionDetails.TAdmissionDate,t)||(a.admissionDetails.TAdmissionDate=t),p(t)}),n()()}if(s&2){let e=c(2);o(4),f("ngModel",e.admissionDetails.TAdmissionDate)}}function st(s,d){if(s&1){let e=B();i(0,"div",21)(1,"div",34)(2,"strong"),l(3,"Date of Discharged "),n()(),i(4,"input",68),b("ngModelChange",function(t){m(e);let a=c(2);return x(a.admissionDetails.DischargeDate,t)||(a.admissionDetails.DischargeDate=t),p(t)}),n()()}if(s&2){let e=c(2);o(4),f("ngModel",e.admissionDetails.DischargeDate)}}function ct(s,d){s&1&&v(0,"div",69)}function dt(s,d){if(s&1){let e=B();i(0,"tr")(1,"td"),l(2),n(),i(3,"td"),l(4),S(5,"uppercase"),n(),i(6,"td")(7,"input",73),b("ngModelChange",function(t){m(e);let a=c().$implicit;return x(a.Rate,t)||(a.Rate=t),p(t)}),n()(),i(8,"td")(9,"input",74),b("ngModelChange",function(t){m(e);let a=c().$implicit;return x(a.Unit,t)||(a.Unit=t),p(t)}),n()(),i(10,"td")(11,"input",75),b("ngModelChange",function(t){m(e);let a=c().$implicit;return x(a.Amount,t)||(a.Amount=t),p(t)}),n()(),i(12,"td",76)(13,"button",77),C("click",function(t){m(e);let a=c().$implicit,h=c(3);return P(67).toggle(t),p(h.selectedDeletingBillItemId=a.BillDetailId)}),v(14,"i",78),n()()()}if(s&2){let e=c(),r=e.$implicit,t=e.index;o(2),D("",t+1,">"),o(2),_(w(5,5,r.HeadDesc)),o(3),f("ngModel",r.Rate),o(2),f("ngModel",r.Unit),o(2),f("ngModel",r.Amount)}}function mt(s,d){if(s&1&&(R(0),y(1,dt,15,7,"tr",4),T()),s&2){let e=d.$implicit;o(),g("ngIf",e.Code!=="Receipt")}}function pt(s,d){if(s&1&&(i(0,"table",70)(1,"thead",71)(2,"tr")(3,"th"),l(4,"#"),n(),i(5,"th"),l(6,"Charges Name"),n(),i(7,"th"),l(8,"Rate"),n(),i(9,"th"),l(10,"Unit"),n(),i(11,"th"),l(12,"Total"),n(),v(13,"th"),n()(),i(14,"tbody"),y(15,mt,2,1,"ng-container",72),n()()),s&2){let e=c(2);o(15),g("ngForOf",e.billItemDetails)}}function gt(s,d){s&1&&v(0,"div",79)}function _t(s,d){if(s&1){let e=B();i(0,"tr")(1,"td"),l(2),n(),i(3,"td"),l(4),S(5,"date"),n(),i(6,"td"),l(7),S(8,"date"),n(),i(9,"td"),l(10),S(11,"uppercase"),n(),i(12,"td"),l(13),S(14,"uppercase"),n(),i(15,"td"),l(16),n(),i(17,"td",80)(18,"button",81),v(19,"i",82),n(),i(20,"button",77),C("click",function(t){let a=m(e).$implicit,h=c(3);return P(67).toggle(t),p(h.selectedDeletingBillItemId=a.BillReceiptId)}),v(21,"i",78),n()()()}if(s&2){let e=d.$implicit,r=d.index;o(2),D("",r+1,">"),o(2),_(W(5,6,e.EntryAt,"dd/MM/yyyy")),o(3),_(W(8,9,e.TranDate,"dd/MM/yyyy")),o(3),_(w(11,12,e.PaymentMode)),o(3),_(w(14,14,e.Payer)),o(3),D("",e.Receipts,".00")}}function ht(s,d){if(s&1&&(i(0,"table",70)(1,"thead",71)(2,"tr")(3,"th"),l(4,"#"),n(),i(5,"th"),l(6,"Entry Date"),n(),i(7,"th"),l(8,"Trans Date"),n(),i(9,"th"),l(10,"Payment Mode"),n(),i(11,"th"),l(12,"Payer"),n(),i(13,"th"),l(14,"Amount"),n(),v(15,"th"),n()(),i(16,"tbody"),y(17,_t,22,16,"tr",72),n()()),s&2){let e=c(2);o(17),g("ngForOf",e.receiptList)}}function ut(s,d){if(s&1){let e=B();i(0,"div",83),v(1,"img",84),i(2,"h4",85)(3,"i"),l(4,"There is no receipt yet..."),n()(),i(5,"h6",86),C("click",function(){m(e),c();let t=P(65);return p(t.click())}),i(6,"u"),l(7,"Please add recepit!"),n()()()}}function ft(s,d){if(s&1){let e=B();i(0,"div",8)(1,"div",87)(2,"small")(3,"strong",43),l(4," Balance : "),n()(),i(5,"small")(6,"strong")(7,"i"),l(8),n()()(),i(9,"small")(10,"strong")(11,"h5"),l(12,"Final Amount"),n()()(),i(13,"input",88),b("ngModelChange",function(t){m(e);let a=c(2);return x(a.chargedAmount,t)||(a.chargedAmount=t),p(t)}),n()()()}if(s&2){let e=c(2);o(8),D(" ",e.patientBalanceAmount," "),o(5),f("ngModel",e.chargedAmount)}}function xt(s,d){if(s&1&&(i(0,"option",67),l(1),S(2,"uppercase"),n()),s&2){let e=d.$implicit;L("value",e),o(),_(w(2,2,e))}}function bt(s,d){if(s&1&&(i(0,"option",67),l(1),S(2,"uppercase"),n()),s&2){let e=d.$implicit;L("value",e),o(),_(w(2,2,e))}}function yt(s,d){if(s&1){let e=B();i(0,"div",90)(1,"div",91)(2,"div",92)(3,"strong")(4,"i"),l(5),n()()(),i(6,"small")(7,"div",93)(8,"strong"),l(9),S(10,"uppercase"),n(),i(11,"strong",94),l(12," Rate : "),i(13,"u"),l(14),n()()()()(),i(15,"div",95)(16,"img",96),C("click",function(t){let a=m(e).$implicit,h=c(3);return P(36).toggle(t),p(h.setSelectedBillItemChargeDetail(a))}),n()()()}if(s&2){let e=d.$implicit,r=d.index;o(5),_(r+1),o(4),_(w(10,3,e.ItemDesc)),o(5),_(e.Rate)}}function Ct(s,d){if(s&1&&(i(0,"div",89)(1,"div",17)(2,"strong"),l(3),n()(),y(4,yt,17,5,"div",18),n()),s&2){let e=c(2);o(3),D("Charges List (",e.filteredList.length,")"),o(),g("ngForOf",e.filteredList)}}function vt(s,d){if(s&1){let e=B();R(0),i(1,"div",31)(2,"div",32)(3,"div",33)(4,"strong"),l(5,"Bill No : "),n(),i(6,"div",21)(7,"h6")(8,"i"),l(9),n()()(),i(10,"div",21)(11,"div",34)(12,"strong"),l(13),n(),v(14,"img",35),n(),y(15,et,3,1,"h6",4)(16,tt,3,1,"h6",4),n(),y(17,it,8,1,"div",36),i(18,"div",21)(19,"div",34)(20,"strong"),l(21,"Doctor Name "),n()(),y(22,nt,3,1,"h6",4)(23,lt,3,1,"h6",4),n(),i(24,"div",21)(25,"div",34)(26,"strong"),l(27,"Payer "),n()(),i(28,"select",37),b("ngModelChange",function(t){m(e);let a=c();return x(a.billDetail.PayerName,t)||(a.billDetail.PayerName=t),p(t)}),i(29,"option",11),l(30,"Select Payer..."),n(),y(31,ot,3,4,"option",12),n()(),i(32,"div",21)(33,"div",34)(34,"strong"),l(35,"TPA "),n()(),i(36,"select",37),b("ngModelChange",function(t){m(e);let a=c();return x(a.billDetail.TPA,t)||(a.billDetail.TPA=t),p(t)}),i(37,"option",11),l(38,"Select TPA..."),n(),y(39,at,3,4,"option",12),n()(),y(40,rt,5,1,"div",36)(41,st,5,1,"div",36),n()(),i(42,"div",38)(43,"div",33)(44,"div",21)(45,"div",39)(46,"div",8)(47,"button",40),C("click",function(){m(e);let t=c();return p(t.loadBillDetailsByBillId(t.billDetail.BillNo))}),i(48,"div",41),y(49,ct,1,0,"div",42),i(50,"strong",43),l(51,"Refresh"),n()()(),i(52,"button",44),C("click",function(t){m(e);let a=c();return p(a.showBillLockAlertPopUp(t))}),i(53,"div",41),v(54,"img",45),i(55,"strong",43),l(56,"Lock"),n()()()(),i(57,"p-selectButton",46),b("ngModelChange",function(t){m(e);let a=c();return x(a.value,t)||(a.value=t),p(t)}),n(),i(58,"div",8)(59,"button",47)(60,"div",41),v(61,"img",48),i(62,"strong",43),l(63,"Discount Notes"),n()()(),i(64,"button",49,3),C("click",function(){m(e);let t=c();return p(t.showReceiptDialoge())}),i(66,"div",41),v(67,"img",50),i(68,"strong",43),l(69,"Add Receipt"),n()()(),i(70,"button",51),C("click",function(t){m(e);let a=c();return p(a.showBillSaveAlertPopUp(t))}),i(71,"div",41),v(72,"img",52),i(73,"strong",43),l(74,"Save"),n()()()()(),i(75,"div",53),y(76,pt,16,1,"table",54)(77,gt,1,0,"div",55)(78,ht,18,1,"table",54)(79,ut,8,0,"div",56),n()()(),i(80,"div",57)(81,"div",58)(82,"div",59)(83,"div",8)(84,"div",60)(85,"strong",43),l(86," Total : "),n(),i(87,"strong")(88,"i"),l(89),n()()(),i(90,"div",61)(91,"strong",43),l(92," Discount : "),n(),i(93,"strong")(94,"i"),l(95),n()()()(),i(96,"div",8)(97,"div",62)(98,"strong",43),l(99," Received : "),n(),i(100,"strong")(101,"i"),l(102),n()()(),i(103,"div",63)(104,"strong",43),l(105," Balance : "),n(),i(106,"strong")(107,"i"),l(108),n()()()(),y(109,ft,14,2,"div",64),n()()()(),i(110,"div",32)(111,"div",65)(112,"div",8)(113,"div",9)(114,"small")(115,"strong"),l(116,"Rate Type"),n()(),i(117,"select",10),b("ngModelChange",function(t){m(e);let a=c();return x(a.selectedRateType,t)||(a.selectedRateType=t),p(t)}),i(118,"option",11),l(119,"Select Type..."),n(),y(120,xt,3,4,"option",12),n()(),i(121,"div",9)(122,"small")(123,"strong"),l(124,"Sub Type"),n()(),i(125,"select",10),b("ngModelChange",function(t){m(e);let a=c();return x(a.selectedRateSubType,t)||(a.selectedRateSubType=t),p(t)}),i(126,"option",11),l(127,"Select Sub Type..."),n(),y(128,bt,3,4,"option",12),n()()(),i(129,"div",13),v(130,"input",14),i(131,"button",15),l(132,"Search"),n()(),y(133,Ct,5,2,"div",66),n()()(),T()}if(s&2){let e=c();o(9),_(e.billDetail.IPCaseNo),o(4),D("",e.billType.toLowerCase().includes("ipd")?"Admission":"Appointment"," Id "),o(2),g("ngIf",e.billType.toLowerCase().includes("ipd")&&e.admissionDetails),o(),g("ngIf",e.billType.toLowerCase().includes("opd")&&e.appointmentDetails),o(),g("ngIf",e.patientDetail),o(5),g("ngIf",e.billType.toLowerCase().includes("ipd")&&e.admissionDetails),o(),g("ngIf",e.billType.toLowerCase().includes("opd")&&e.appointmentDetails),o(5),f("ngModel",e.billDetail.PayerName),o(3),g("ngForOf",e.payerList),o(5),f("ngModel",e.billDetail.TPA),o(3),g("ngForOf",e.tpaList),o(),g("ngIf",e.admissionDetails),o(),g("ngIf",e.admissionDetails),o(8),g("ngIf",e.isRefreshing),o(8),g("options",e.stateOptions),f("ngModel",e.value),o(7),g("disabled",!e.billItemDetails.length)("pTooltip",e.billItemDetails.length?"Add receipt":"Please add charges first!"),o(12),g("ngIf",e.value.toLowerCase()==="bill"&&e.billItemDetails.length),o(),g("ngIf",e.value.toLowerCase()==="bill"&&!e.billItemDetails.length),o(),g("ngIf",e.value.toLowerCase()==="receipt"&&e.receiptList.length),o(),g("ngIf",e.value.toLowerCase()==="receipt"&&!e.receiptList.length),o(10),_(e.chargedAmount),o(6),D(" ",e.billDetail.DiscountAmt," "),o(7),D(" ",e.patientGivenAmount," "),o(6),D(" ",e.patientBalanceAmount," "),o(),g("ngIf",!1),o(8),f("ngModel",e.selectedRateType),g("disabled",!e.rateTypeList.length),o(3),g("ngForOf",e.rateTypeList),o(5),f("ngModel",e.selectedRateSubType),g("disabled",!e.rateSubTypeList.length),o(3),g("ngForOf",e.rateSubTypeList),o(5),g("ngIf",e.filteredList.length)}}function St(s,d){s&1&&(i(0,"span"),l(1," Admission Id "),n())}function wt(s,d){s&1&&(i(0,"span"),l(1," Appointment Id "),n())}function Dt(s,d){if(s&1&&(i(0,"span")(1,"i"),l(2),n()()),s&2){let e=c(2);o(2),_(e.admissionDetails.RegNo)}}function Bt(s,d){if(s&1&&(i(0,"span")(1,"i"),l(2),n()()),s&2){let e=c(2);o(2),_(e.appointmentDetails.RegNo)}}function It(s,d){if(s&1){let e=B();i(0,"div",115)(1,"small")(2,"div",116)(3,"strong",117),l(4),n(),i(5,"div",118)(6,"strong"),l(7),S(8,"uppercase"),n(),i(9,"div",119)(10,"div",91)(11,"strong",104),l(12,"R -"),n(),i(13,"i"),l(14),n()(),i(15,"div",91)(16,"strong",105),l(17,"U -"),n(),i(18,"i"),l(19),n()(),i(20,"div",91)(21,"strong",106),l(22,"C -"),n(),i(23,"i"),l(24),n()()()()()(),i(25,"div",120),C("click",function(t){m(e),c(4);let a=P(67);return p(a.toggle(t))}),i(26,"strong"),l(27,"Delete"),n()()()}if(s&2){let e=c(),r=e.$implicit,t=e.index;o(4),_(t+1),o(3),_(w(8,5,r.HeadDesc)),o(7),_(r.Rate),o(5),_(r.Unit),o(5),_(r.Amount)}}function Et(s,d){if(s&1&&(R(0),y(1,It,28,7,"div",114),T()),s&2){let e=d.$implicit;o(),g("ngIf",e.Code!=="Receipt")}}function Rt(s,d){if(s&1&&(R(0),y(1,Et,2,1,"ng-container",72),T()),s&2){let e=c(2);o(),g("ngForOf",e.billItemDetails)}}function Tt(s,d){s&1&&(R(0),i(1,"div",121),v(2,"img",122),i(3,"h4"),l(4,"You have not charged "),v(5,"br"),l(6," any charges."),n()(),T())}function Mt(s,d){if(s&1){let e=B();i(0,"div",115)(1,"div",41)(2,"strong",117),l(3),n(),i(4,"div",118)(5,"small")(6,"div",59)(7,"div",8)(8,"strong"),l(9,"Pay Mode : "),n(),i(10,"i")(11,"strong"),l(12),S(13,"uppercase"),n()()()(),i(14,"div",59)(15,"div",8)(16,"strong"),l(17,"Tranc. At : "),n(),i(18,"i")(19,"strong"),l(20),S(21,"date"),n()()(),i(22,"div",124)(23,"strong"),v(24,"i",125),l(25," : "),n(),i(26,"i")(27,"strong"),l(28),n()()()()()(),v(29,"img",101),n(),i(30,"div",120),C("click",function(t){m(e),c(3);let a=P(67);return p(a.toggle(t))}),i(31,"strong"),l(32,"Delete"),n()()()}if(s&2){let e=d.$implicit,r=d.index;o(3),_(r+1),o(9),_(w(13,4,e.PaymentMode)),o(8),_(W(21,6,e.TranDate,"dd/MM/yyyy")),o(8),_(e.Receipts)}}function Lt(s,d){if(s&1&&(R(0),y(1,Mt,33,9,"div",123),T()),s&2){let e=c(2);o(),g("ngForOf",e.receiptList)}}function Pt(s,d){s&1&&(R(0),i(1,"div",121),v(2,"img",126),i(3,"h4"),l(4,"There is no receipt, yet!"),n()(),T())}function At(s,d){if(s&1){let e=B();R(0),i(1,"div",97)(2,"div",98)(3,"div",8)(4,"small")(5,"strong"),l(6," Bill No : "),n()(),i(7,"small")(8,"i")(9,"u"),l(10),n()()()(),v(11,"hr",99),i(12,"div",100)(13,"div",21)(14,"strong")(15,"small"),l(16,"Patient Name"),n()(),i(17,"small")(18,"i"),l(19),n()()(),v(20,"img",101),n(),v(21,"hr",99),i(22,"div",100)(23,"div",21)(24,"strong")(25,"small"),y(26,St,2,0,"span",4)(27,wt,2,0,"span",4),n()(),i(28,"small"),y(29,Dt,3,1,"span",4)(30,Bt,3,1,"span",4),n()(),v(31,"img",101),n(),v(32,"hr",99),i(33,"div",102)(34,"p-selectButton",103),C("onChange",function(){m(e);let t=c();return p(t.setFloatingAmountCard())}),b("ngModelChange",function(t){m(e);let a=c();return x(a.value,t)||(a.value=t),p(t)}),n(),i(35,"div",91)(36,"strong")(37,"span",104),l(38,"R"),n(),i(39,"span"),l(40,"- Rate | "),n(),i(41,"span",105),l(42,"U"),n(),i(43,"span"),l(44,"- Unit | "),n(),i(45,"span",106),l(46,"C"),n(),i(47,"span"),l(48,"- Cost "),n()()()(),i(49,"div",107),y(50,Rt,2,1,"ng-container",4)(51,Tt,7,0,"ng-container",4)(52,Lt,2,1,"ng-container",4)(53,Pt,5,0,"ng-container",4),i(54,"div",108)(55,"div",109)(56,"div",110)(57,"div",111)(58,"small")(59,"strong"),l(60,"Balance"),n()(),i(61,"input",88),b("ngModelChange",function(t){m(e);let a=c();return x(a.patientBalanceAmount,t)||(a.patientBalanceAmount=t),p(t)}),n()(),i(62,"div",112)(63,"small")(64,"strong"),l(65,"Final"),n()(),i(66,"input",88),b("ngModelChange",function(t){m(e);let a=c();return x(a.billDetail.TotalAmt,t)||(a.billDetail.TotalAmt=t),p(t)}),n()(),v(67,"div",113),n()()()()()(),T()}if(s&2){let e=c();o(10),D(" ",e.billDetail.IPCaseNo," "),o(9),D(" ",e.patientDetail.EntityName," "),o(7),g("ngIf",e.billType.toLowerCase().includes("ipd")&&e.admissionDetails),o(),g("ngIf",e.billType.toLowerCase().includes("opd")&&e.appointmentDetails),o(2),g("ngIf",e.billType.toLowerCase().includes("ipd")&&e.admissionDetails),o(),g("ngIf",e.billType.toLowerCase().includes("opd")&&e.appointmentDetails),o(4),g("options",e.stateOptions),f("ngModel",e.value),o(16),g("ngIf",e.value.toLowerCase()==="bill"&&e.billItemDetails.length),o(),g("ngIf",e.value.toLowerCase()==="bill"&&!e.billItemDetails.length),o(),g("ngIf",e.value.toLowerCase()==="receipt"),o(),g("ngIf",e.value.toLowerCase()==="receipt"&&!e.receiptList.length),o(),A(e.floatAmountCardPostion),o(7),f("ngModel",e.patientBalanceAmount),o(5),f("ngModel",e.billDetail.TotalAmt)}}function Vt(s,d){if(s&1&&(i(0,"div",149)(1,"div",150)(2,"div",151)(3,"strong"),l(4),n()(),i(5,"div",152)(6,"strong"),l(7),S(8,"uppercase"),n(),i(9,"div",153)(10,"strong",139),l(11),n(),i(12,"strong",140),l(13),n(),i(14,"strong",141),l(15),n()()()()()),s&2){let e=d.$implicit,r=d.index;o(4),_(r+1),o(3),_(w(8,5,e.HeadDesc)),o(4),D("R: ",e.Rate,""),o(2),D("U: ",e.Unit,""),o(2),D("C: ",e.Amount,"")}}function kt(s,d){if(s&1&&(i(0,"div",147),y(1,Vt,16,7,"div",148),n()),s&2){let e=c(3);o(),g("ngForOf",e.billItemDetails)}}function Nt(s,d){if(s&1){let e=B();i(0,"div",128)(1,"div",129)(2,"div",130)(3,"div",131)(4,"small")(5,"strong"),l(6,"Bill No"),n()(),i(7,"i"),l(8),S(9,"uppercase"),n()(),i(10,"div",132)(11,"small")(12,"strong"),l(13,"Bill Date"),n()(),i(14,"i"),l(15),S(16,"date"),n()()(),i(17,"div",133)(18,"div",131)(19,"small")(20,"strong"),l(21,"Payer"),n()(),i(22,"i"),l(23),S(24,"uppercase"),n()(),i(25,"div",132)(26,"small")(27,"strong"),l(28,"TPA"),n()(),i(29,"i",134),l(30),S(31,"uppercase"),n()()()(),y(32,kt,2,1,"div",135),i(33,"div",136)(34,"div",137)(35,"label",138)(36,"span",139),l(37,"R"),n(),i(38,"strong"),l(39,": Rate"),n()(),i(40,"label",138)(41,"span",140),l(42,"U"),n(),i(43,"strong"),l(44,": Unit"),n()(),i(45,"label",138)(46,"span",141),l(47,"C"),n(),i(48,"strong"),l(49,": Cost"),n()()(),i(50,"div",130)(51,"div",131)(52,"small")(53,"strong"),l(54,"Balance"),n()(),i(55,"i",94)(56,"strong"),l(57),n()()(),i(58,"div",132)(59,"small")(60,"strong"),l(61,"Paid"),n()(),i(62,"i",142)(63,"strong"),l(64),n()()()(),i(65,"div",133)(66,"div",131)(67,"small")(68,"strong"),l(69,"Discount"),n()(),i(70,"i",143)(71,"strong"),l(72),n()()(),i(73,"div",132)(74,"small")(75,"strong"),l(76,"Final"),n()(),i(77,"i",144)(78,"strong"),l(79),n()()()(),i(80,"div",145)(81,"div",146),C("click",function(){m(e);let t=c(2);return p(t.moreDetails=!t.moreDetails)}),v(82,"img",35),i(83,"strong"),l(84,"More detail"),n()()()()()}if(s&2){let e=c(2);o(8),_(w(9,9,e.billDetail.IPCaseNo)),o(7),_(W(16,11,e.billDetail.BillDate,"dd-MMM-yyyy")),o(8),_(w(24,14,e.billDetail.PayerName)),o(7),_(e.billDetail.TPA&&e.billDetail.TPA.toLowerCase().includes("none")?e.billDetail.TPA:w(31,16,"-")),o(2),g("ngIf",e.billItemDetails.length),o(25),_(e.billDetail.AmountToPatient),o(7),_(e.billDetail.AmountToPayer),o(8),_(e.billDetail.DiscountAmt),o(7),_(e.billDetail.TotalAmt)}}function Wt(s,d){if(s&1&&(R(0),y(1,Nt,85,18,"div",127),T()),s&2){let e=c();o(),g("ngIf",e.billItemDetails.length)}}function Ft(s,d){if(s&1&&(i(0,"div",154)(1,"div",147)(2,"div",155)(3,"small")(4,"strong"),l(5,"Patient Name"),n(),l(6),n(),i(7,"strong"),l(8),n()()(),i(9,"div",147)(10,"div",155)(11,"small")(12,"strong"),l(13,"UHID No"),n()(),i(14,"strong"),l(15),n()()(),i(16,"div",147)(17,"div",155)(18,"small")(19,"strong"),l(20,"Department"),n()(),i(21,"strong"),l(22),n()()(),i(23,"div",147)(24,"div",155)(25,"small")(26,"strong"),l(27,"Hopital Section"),n()(),i(28,"strong"),l(29),n()()(),i(30,"div",147)(31,"div",155)(32,"small")(33,"strong"),l(34,"Patient Category"),n()(),i(35,"strong"),l(36),n()()(),i(37,"div",147)(38,"div",155)(39,"small")(40,"strong"),l(41,"Admission Date"),n()(),i(42,"strong"),l(43),S(44,"date"),n()()(),i(45,"div",147)(46,"div",155)(47,"small")(48,"strong"),l(49,"Married Status"),n()(),i(50,"strong"),l(51),S(52,"uppercase"),n()()(),i(53,"div",147)(54,"div",155)(55,"small")(56,"strong"),l(57,"Reg No"),n()(),i(58,"strong"),l(59),S(60,"uppercase"),n()()(),i(61,"div",147)(62,"div",155)(63,"small")(64,"strong"),l(65,"Contact No"),n()(),i(66,"strong"),l(67),n()()(),i(68,"div",147)(69,"div",155)(70,"small")(71,"strong"),l(72,"Gender"),n()(),i(73,"strong"),l(74),n()()(),i(75,"div",147)(76,"div",155)(77,"small")(78,"strong"),l(79,"Date of Birth"),n()(),i(80,"strong"),l(81),n()()(),i(82,"div",147)(83,"div",155)(84,"small")(85,"strong"),l(86,"Age"),n()(),i(87,"strong"),l(88),n()()(),i(89,"div",147)(90,"div",155)(91,"small")(92,"strong"),l(93,"City/Village"),n()(),i(94,"strong"),l(95),n()()(),i(96,"div",147)(97,"div",155)(98,"small")(99,"strong"),l(100,"State"),n()(),i(101,"strong"),l(102),n()()(),i(103,"div",147)(104,"div",155)(105,"small")(106,"strong"),l(107,"Country"),n()(),i(108,"strong"),l(109),n()()()()),s&2){let e=c();o(6),D(" (",e.patientDetail.EntityId,")"),o(2),_(e.patientDetail.EntityName),o(7),_(e.patientDetail.RegNo),o(7),_(e.billDetail.B_Department),o(7),_(e.billDetail.B_WhichOpd),o(7),_(e.patientDetail.ExternalCategory),o(7),_(W(44,16,e.billDetail.AdmissionDate,"dd-MMM-yyyy hh:mm a")),o(8),_(e.patientDetail.MaritalStatus?e.patientDetail.MaritalStatus:w(52,19,"-")),o(8),_(w(60,21,e.patientDetail.RegNo)),o(8),_(e.patientDetail.PrimaryFld1?e.patientDetail.PrimaryFld1:"-"),o(7),_(e.patientDetail.PrimaryFld2?e.patientDetail.PrimaryFld2:"-"),o(7),_(e.patientDetail.PrimaryFld3?e.patientDetail.PrimaryFld3:"-"),o(7),_(e.patientDetail.PrimaryId1?e.patientDetail.PrimaryId1:"-"),o(7),_(e.patientDetail.PrimaryFld4?e.patientDetail.PrimaryFld4:"-"),o(7),_(e.patientDetail.State?e.patientDetail.State:"-"),o(7),_(e.patientDetail.Country?e.patientDetail.Country:"-")}}function Ut(s,d){if(s&1&&(i(0,"option",67),l(1),S(2,"uppercase"),n()),s&2){let e=d.$implicit;L("value",e),o(),_(w(2,2,e))}}function Ot(s,d){if(s&1&&(i(0,"option",67),l(1),S(2,"uppercase"),n()),s&2){let e=d.$implicit;L("value",e),o(),_(w(2,2,e))}}function jt(s,d){if(s&1){let e=B();i(0,"div",90)(1,"div",91)(2,"div",92)(3,"strong")(4,"i"),l(5),n()()(),i(6,"small")(7,"div",93)(8,"strong"),l(9),S(10,"uppercase"),n(),i(11,"strong",94),l(12," Rate : "),i(13,"u"),l(14),n()()()()(),i(15,"div",95)(16,"img",96),C("click",function(t){let a=m(e).$implicit,h=c();return P(36).toggle(t),p(h.setSelectedBillItemChargeDetail(a))}),n()()()}if(s&2){let e=d.$implicit,r=d.index;o(5),_(r+1),o(4),_(w(10,3,e.ItemDesc)),o(5),_(e.Rate)}}function Ht(s,d){if(s&1){let e=B();i(0,"div",156)(1,"span"),l(2),n(),i(3,"div",157)(4,"button",26),C("click",function(){m(e);let t=c();return p(t.confirmPopup.accept())}),l(5,"Yes"),n(),i(6,"button",158),C("click",function(){m(e);let t=c();return p(t.confirmPopup.reject())}),l(7,"No"),n()()()}if(s&2){let e=d.$implicit;o(2),_(e.message)}}var wi=(()=>{class s{constructor(e,r,t,a,h,u,pe,Z,M){this._billServices=e,this._dialogConfig=r,this._patientServices=t,this._activatedRoute=a,this._appointmentServices=h,this._admissionServices=u,this._commonServices=pe,this._confirmationService=Z,this._dialogService=M,this.caseId=0,this.patientId=0,this.billNo=0,this.visible=!1,this.billDetail=new de,this.billItemDetails=[],this.patientDetail=new me,this.moreDetails=!1,this.billChargesPopup=!1,this.billType="",this.stateOptions=[{label:"Charges",value:"bill"},{label:"Receipts",value:"receipt"}],this.value="bill",this.payerList=[],this.tpaList=[],this.isRefreshing=!1,this.appointmentDetails=null,this.admissionDetails=null,this.chargedAmount="0",this.patientGivenAmount=0,this.patientBalanceAmount=0,this.receiptList=[],this.floatAmountCardPostion="position:sticky; bottom: 0%;",this.rateTypeList=[],this.rateSubTypeList=[],this.selectedRateType="",this.selectedRateSubType="",this.rateList=[],this.billItemCharge=new ce,this.selectedDeletingBillItemId=0,this.reasonForDeleteBillItemDetail="",this.testList=[],this.filteredList=[]}ngOnInit(){debugger;this.loadTpaList(),this.loadPayerList();let e=this._dialogConfig.data||null;e&&(this.billNo=e.billNo||0,this.billType=e.billType||"",this.billNo&&(console.log(this.billNo),this.loadBillDetailsByBillId(this.billNo))),e||(this._dialogService.dialogComponentRefMap.forEach(r=>{r.destroy()}),this._activatedRoute.queryParams.subscribe(r=>{this.billNo=r.billId?Number(r.billId):0,this.caseId=r.caseId?Number(r.caseId):0,this.patientId=r.patientId?Number(r.patientId):0}),this.billType=this.billType?this.billType:history.state.hospitalSection,this.loadBillDetailsByBillId(this.billNo)),this.billType.toLowerCase().includes("path")?this.loadPathLabTestList():this.loadRateTypeList(),this._commonServices.setHospitalSection(ee.hospitalSection===this.billType?ee.hospitalSection:ee.hospitalSection+" > "+this.billType+" - Bill Management")}ngDoCheck(){}loadBillDetailsByBillId(e){this.isRefreshing=!0,e&&this._billServices.getBillDetailsByBillNo(e).subscribe(r=>{if(this.isRefreshing=!1,console.log(r),r.Status.toLowerCase().includes("success")&&r.noofREcords){this.billDetail=new de,this.billDetail=r.dataSet.Table[0];let t="";this.billType.toLowerCase()==="path"&&(t=this.billType);let a=this._commonServices.getHospitalSection();a&&(this.billType=t||a,console.log(this.billType),a.toLowerCase().includes("opd")&&(console.log("Load OPD Details"),this.loadAppointmentDetailsByAppointmentId()),a.toLowerCase().includes("ipd")&&(console.log("Load IPD Details"),this.loadAdmissionDetailsByAdmissionId())),this.loadBillItemDetailsByBillId(this.billNo),this.loadPatientDetail(this.billDetail.PatientId)}},r=>{console.error(r),this.isRefreshing=!1,alert("Please check log, for more detail.")})}loadBillItemDetailsByBillId(e){this._billServices.getBillItemDetailsByBillNo(e).subscribe(r=>{if(console.log(r),this.loadReceiptListByBillId(),r.Status.toLowerCase().includes("success")&&r.noofREcords){this.billItemDetails=[],this.billItemDetails=r.dataSet.Table;let t=0;this.billItemDetails.forEach(a=>{a.Code!=="Receipt"&&(t=t+a.Amount)}),this.chargedAmount=t.toString(),this.validPlatform("window")&&this.setFloatingAmountCard()}},r=>{console.error(r)})}loadPatientDetail(e){this._patientServices.getPatientDetailsByPatientId(e||this.patientId).subscribe(r=>{console.log(r),r.Status.toLowerCase().includes("success")&&r.noofREcords&&(this.patientDetail=new me,this.patientDetail=r.dataSet.Table[0])},r=>{console.error(r)})}loadAppointmentDetailsByAppointmentId(){this._appointmentServices.getAppointmentDetailsByAppointmentIdPatientId(this.caseId,this.patientId).subscribe(e=>{console.log(e),e.Status.toLowerCase().includes("success")&&e.noofREcords&&(this.appointmentDetails=null,this.appointmentDetails=e.dataSet.Table[0],console.log("Appointment Detail =>",this.appointmentDetails))},e=>{console.error("getAppointmentDetailsByAppointmentIdPatientId =>",e),alert("Please check log, for more details.")})}loadAdmissionDetailsByAdmissionId(){this._admissionServices.getAddmissionDetailsByAdmissionIdPatientId(this.caseId,this.patientId).subscribe(e=>{console.log(e),e.Status.toLowerCase().includes("success")&&e.noofREcords&&(this.admissionDetails=null,this.admissionDetails=e.dataSet.Table[0])},e=>{console.error("getAddmissionDetailsByAdmissionIdPatientId =>",e),alert("Please check log, for more details.")})}loadReceiptListByBillId(){this._billServices.getRecieptListByBillId(this.billDetail.BillNo).subscribe(e=>{console.log("getRecieptListByBillId =>",e),e.Status.toLowerCase().includes("success")&&e.noofREcords&&(this.receiptList=[],this.receiptList=e.dataSet.Table),this.calculatePatientGivenAndBalance()},e=>{console.error("getRecieptListByBillId =>",e),alert("Please check log, for more details")})}calculatePatientGivenAndBalance(){this.patientGivenAmount=0,this.patientBalanceAmount=0,this.receiptList.length&&this.receiptList.forEach(e=>{this.patientGivenAmount=e.Receipts+this.patientGivenAmount}),this.patientBalanceAmount=Number(this.chargedAmount)-this.patientGivenAmount}showBillLockAlertPopUp(e){this._confirmationService.confirm({target:e.target,message:"Are you sure, you like to lock bill "+this.billDetail.IPCaseNo.toUpperCase()+" ?",accept:()=>{},reject:()=>{}})}showBillSaveAlertPopUp(e){this._confirmationService.confirm({target:e.target,message:"Are you sure, you like to save bill "+this.billDetail.IPCaseNo.toUpperCase()+" ?",accept:()=>{},reject:()=>{}})}showBillItemDeleteAlertPopUp(e){this._confirmationService.confirm({target:e.target,message:"Are you sure, you like to delete this charge?",accept:()=>{this.deleteBillItemByBillItemIdBillNo()},reject:()=>{}})}showBillItemChargeAlertPopUp(e){this._confirmationService.confirm({target:e.target,message:"Are you sure, you like to add this charge?",accept:()=>{},reject:()=>{}})}loadPayerList(){this._commonServices.getPayerList().subscribe(e=>{console.log("getPayerList =>",e),e.Status.toLowerCase().includes("success")&&e.noofREcords&&(this.payerList=[],this.payerList=e.dataSet.Table)},e=>{console.error("getPayerList =>",e),alert("Please check log, for more details")})}loadTpaList(){this._commonServices.getTpaList().subscribe(e=>{console.log("getTpaList =>",e),e.Status.toLowerCase().includes("success")&&e.noofREcords&&(this.tpaList=[],this.tpaList=e.dataSet.Table)},e=>{console.error("getTpaList =>",e),alert("Please check log, for more details")})}showReceiptDialoge(){let e=this._dialogService.open(Ae,{header:"Receipt For "+this.billDetail.IPCaseNo.toUpperCase(),width:"auto",data:{billNo:this.billDetail.BillNo.toString()||"",receivedAmount:this.patientGivenAmount,billType:this.billType}})}validPlatform(e){return this._commonServices.checkPlatform(e)}setFloatingAmountCard(){this.value.toLowerCase().includes("bill")&&!this.billItemDetails.length?this.floatAmountCardPostion="position:absolute; bottom: 0%;":this.value.toLowerCase().includes("bill")&&this.billItemDetails.length<7?this.floatAmountCardPostion="position:absolute; bottom: 0%;":this.value.toLowerCase().includes("bill")&&this.billItemDetails.length>=7?this.floatAmountCardPostion="position:sticky; bottom: 0%;":this.value.toLowerCase().includes("receipt")&&!this.receiptList.length?this.floatAmountCardPostion="position:absolute; bottom: 0%;":this.value.toLowerCase().includes("receipt")&&this.receiptList.length<7?this.floatAmountCardPostion="position:absolute; bottom: 0%;":this.value.toLowerCase().includes("receipt")&&this.receiptList.length>=7?this.floatAmountCardPostion="position:sticky; bottom: 0%;":this.floatAmountCardPostion="position:absolute; bottom: 0%;"}loadRateTypeList(){this._billServices.getRateTypeList().subscribe(e=>{e.Status.toLowerCase().includes("success")&&e.noofREcords&&(this.rateTypeList=[],e.dataSet.Table.forEach(r=>{r.ListItem&&this.rateTypeList.push(r.ListItem)}),this.selectedRateType=this.rateTypeList[0],this.loadSubRateTypeList())},e=>{console.error(e),alert("Please check log, for more detail.")})}loadSubRateTypeList(){this._billServices.getSubRateTypeList().subscribe(e=>{e.Status.toLowerCase().includes("success")&&e.noofREcords&&(this.rateSubTypeList=[],e.dataSet.Table.forEach(r=>{r.ListItem&&(r.ListItem.toLowerCase()===this.billType.toLowerCase()&&(this.selectedRateSubType=r.ListItem),this.rateSubTypeList.push(r.ListItem))}),this.selectedRateSubType=this.selectedRateSubType.toLowerCase()===this.billType.toLowerCase()?this.selectedRateSubType:this.rateSubTypeList[0],this.loadRateListByRateTypeAndRateSubType())},e=>{console.error(e),alert("Please check log, for more detail.")})}loadRateListByRateTypeAndRateSubType(){this._billServices.getRateListByRateTypeRateSubType(this.selectedRateType,this.selectedRateSubType).subscribe(e=>{console.log(e),e.Status.toLowerCase().includes("success")&&e.noofREcords&&(this.rateList=[],this.rateList=e.dataSet.Table,this.filterItemRateByName())},e=>{console.error(e),alert("Please check log, for more detail.")})}saveBillItem(){}setSelectedBillItemChargeDetail(e){this.billItemCharge.HeadDesc=e.ItemDesc,this.billItemCharge.Code=e.ItemCode,this.billItemCharge.Rate=e.Rate.toString(),this.billItemCharge.Amount=e.Rate.toString(),this.billItemCharge.RateId=e.RateId.toString()}calculateFinalRateAmount(){this.billItemCharge.Amount=(Number(this.billItemCharge.Unit)*Number(this.billItemCharge.Rate)).toString()}deleteEntryByBillReceipt(){this.value.toLowerCase().includes("bill")&&this.deleteBillItemByBillItemIdBillNo(),this.value.toLowerCase().includes("receipt")&&this.deleteBillIReceiptByBillReceiptIdBillNo()}deleteBillItemByBillItemIdBillNo(){this.reasonForDeleteBillItemDetail?this._billServices.deleteBillItem(this.selectedDeletingBillItemId,this.billDetail.BillNo,this.reasonForDeleteBillItemDetail).subscribe(e=>{console.log(e),document.getElementById("reasonForDeleteBillItemHide")?.click(),this.reasonForDeleteBillItemDetail="",e.Status.toLowerCase().includes("success")&&this.loadBillDetailsByBillId(this.billDetail.BillNo),e.Status.toLowerCase().includes("failed")&&this.loadBillDetailsByBillId(this.billDetail.BillNo)},e=>{console.error(e),alert("Please check log, for more detail."),document.getElementById("reasonForDeleteBillItemHide")?.click(),this.reasonForDeleteBillItemDetail=""}):(alert("Please add reason for delete?"),document.getElementById("reasonForDeleteBillItemInput")?.focus())}deleteBillIReceiptByBillReceiptIdBillNo(){this.reasonForDeleteBillItemDetail?this._billServices.deleteBillReceipt(this.selectedDeletingBillItemId,this.billDetail.BillNo,this.reasonForDeleteBillItemDetail).subscribe(e=>{console.log(e),document.getElementById("reasonForDeleteBillItemHide")?.click(),this.reasonForDeleteBillItemDetail="",e.Status.toLowerCase().includes("success")&&this.loadBillDetailsByBillId(this.billDetail.BillNo),e.Status.toLowerCase().includes("failed")&&this.loadBillDetailsByBillId(this.billDetail.BillNo)},e=>{console.error(e),alert("Please check log, for more detail."),document.getElementById("reasonForDeleteBillItemHide")?.click(),this.reasonForDeleteBillItemDetail=""}):(alert("Please add reason for delete?"),document.getElementById("reasonForDeleteBillItemInput")?.focus())}loadPathLabTestList(){this._billServices.getPathTestList().subscribe(e=>{console.log(e);debugger;e.Status.toLowerCase().includes("success")&&e.noofREcords&&(this.testList=[],this.testList=e.dataSet.Table),this.filterItemRateByName()},e=>{console.error(e),alert("Please check log, for more detail.")})}filterItemRateByName(e){debugger;let r=[];this.billType.toLowerCase()==="path"?e&&e!==void 0?this.testList.length?this.testList.forEach(t=>{if(t.TestName.toLowerCase().includes(e.toLowerCase())){let a=new q;a.ItemCode=t.PathTestId.toString(),a.ItemDesc=t.TestName.toString(),a.Provider=t.Remarks.toString(),a.Rate=Number(t.Amount),a.RateId=t.PathTestId,a.RoomType=t.PathLabid.toString(),r.push(a)}}):this.testList.forEach(t=>{let a=new q;a.ItemCode=t.PathTestId.toString(),a.ItemDesc=t.TestName.toString(),a.Provider=t.Remarks.toString(),a.Rate=Number(t.Amount),a.RateId=t.PathTestId,a.RoomType=t.PathLabid.toString(),r.push(a)}):this.testList.forEach(t=>{let a=new q;a.ItemCode=t.PathTestId.toString(),a.ItemDesc=t.TestName.toString(),a.Provider=t.Remarks.toString(),a.Rate=Number(t.Amount),a.RateId=t.PathTestId,a.RoomType=t.PathLabid.toString(),r.push(a)}):e&&e!==void 0?this.rateList.length?this.rateList.forEach(t=>{t.ItemDesc.toLowerCase().includes(e.toLowerCase())&&r.push(t)}):r=this.rateList:r=this.rateList,this.filteredList=r}static{this.\u0275fac=function(r){return new(r||s)(I(re),I(V),I(Be),I(be),I(Ie),I(Ee),I(U),I(ye),I(k))}}static{this.\u0275cmp=N({type:s,selectors:[["app-billing-management"]],viewQuery:function(r,t){if(r&1&&he(oe,5),r&2){let a;ue(a=fe())&&(t.confirmPopup=a.first)}},features:[K([V,k])],decls:80,vars:28,consts:[["confirmPopupRef",""],["addChargeWithUnitNote",""],["reasonForDeleteBillItem",""],["addReceiptBtn",""],[4,"ngIf"],["header","More Details","position","bottom",3,"visibleChange","modal","visible"],["class","row",4,"ngIf"],["header","Bill Charges","position","bottom",3,"visibleChange","modal","visible"],[1,"d-flex","flex-row","gap-1"],[1,"d-flex","flex-column","w-50"],["name","","id","",1,"form-select","form-select-sm",3,"ngModelChange","ngModel","disabled"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"d-flex","flex-row","gap-1","mt-1"],["type","text","placeholder","Search charges here...",1,"form-control","form-control-sm"],["type","button",1,"btn","btn-sm","btn-primary"],[1,"mt-2","relative",2,"overflow-y","auto","max-height","60vh"],[1,"sticky","sticky-top","bg-white"],["class","card shadow-lg border-0 rounded-2 mb-1 rate-charge","style","position: relative;",4,"ngFor","ngForOf"],["pTemplate","headless"],[1,"d-flex","flex-column",2,"max-width","300px"],[1,"d-flex","flex-column"],["type","text",1,"form-control","form-control-sm",3,"ngModelChange","keyup","ngModel"],["name","","id","","rows","3","cols","3",1,"form-control","form-control-sm",3,"ngModelChange","ngModel"],["type","text","disabled","",1,"form-control","form-control-sm",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-around","mt-2"],["type","button",1,"btn","btn-sm","btn-success",3,"click"],["type","button","id","addChargeWithUnitNoteHide",1,"btn","btn-sm","btn-danger",3,"click"],["id","reasonForDeleteBillItemInput","type","text",1,"form-control","form-control-sm",3,"ngModelChange","ngModel"],["type","button",1,"btn","btn-sm","btn-success",3,"click","disabled"],["type","button","id","reasonForDeleteBillItemHide",1,"btn","btn-sm","btn-danger",3,"click"],[1,"d-flex","flex-row","gap-1",2,"min-width","100%"],[1,"d-flex","p-1",2,"min-width","20%","max-width","25%"],[1,"card","shadow-lg","p-2",2,"min-height","92vh","min-width","100%"],[1,"d-flex","flex-row","justify-content-between"],["src","assets/images/info.png","height","20px","alt","","srcset",""],["class","d-flex flex-column",4,"ngIf"],["name","","id","",1,"form-select","form-select-sm",3,"ngModelChange","ngModel"],[1,"d-flex","p-1",2,"min-width","60%","max-width","50%","position","relative"],[1,"d-flex","justify-content-between","mb-1"],["type","button",1,"btn","btn-sm","shadow-lg","btn-warning",3,"click"],[1,"d-flex","flex-row","align-items-center","gap-1"],["class","spinner-grow spinner-grow-sm","role","status",4,"ngIf"],[1,"text-nowrap"],["type","button",1,"btn","btn-sm","shadow-lg","btn-secondary",3,"click"],["src","assets/images/bill-lock.png","height","20px","alt","","srcset",""],["optionLabel","label","optionValue","value",3,"ngModelChange","options","ngModel"],["type","button",1,"btn","btn-sm","shadow-lg","btn-info"],["src","assets/images/offer.png","height","20px","alt","","srcset",""],["type","button","tooltipPosition","bottom",1,"btn","btn-sm","shadow-lg","btn-info",3,"click","disabled","pTooltip"],["src","assets/images/receipt.png","height","20px","alt","","srcset",""],["type","button",1,"btn","btn-sm","shadow-lg","btn-success",3,"click"],["src","assets/images/purse.png","height","20px","alt","","srcset",""],[1,"",2,"overflow-y","auto","max-height","75vh","min-height","75vh"],["class","table table-sm table-bordered",4,"ngIf"],["class","d-flex justify-content-center align-items-center h-100",4,"ngIf"],["class","d-flex flex-column justify-content-center align-items-center h-100",4,"ngIf"],[1,"w-100","p-2",2,"position","absolute","bottom","0"],[1,"card","border-0","rounded-3","shadow-lg","p-1"],[1,"d-flex","justify-content-between"],[1,"d-flex","flex-row","gap-1","p-1","rounded-3","shadow-lg",2,"background-color","#6AD4DD","color","black"],[1,"d-flex","flex-row","p-1","rounded-3","shadow-lg","gap-1",2,"background-color","#FFC764","color","black"],[1,"d-flex","flex-row","gap-1","p-1","rounded-3","shadow-lg",2,"background-color","#5BBCFF","color","black"],[1,"d-flex","flex-row","gap-1","p-1","rounded-3","shadow-lg",2,"background-color","#FF9B9B","color","black"],["class","d-flex flex-row gap-1",4,"ngIf"],[1,"card","shadow-lg","p-2","gap-1",2,"min-height","92vh","min-width","100%"],["class","mt-2 relative","style","overflow-y: auto; max-height: 80vh;",4,"ngIf"],[3,"value"],["type","datetime-local","name","","id","","disabled","",1,"form-control","form-control-sm",3,"ngModelChange","ngModel"],["role","status",1,"spinner-grow","spinner-grow-sm"],[1,"table","table-sm","table-bordered"],[2,"position","sticky","top","0"],[4,"ngFor","ngForOf"],["type","text",1,"form-control","form-control-sm","w-5rem",3,"ngModelChange","ngModel"],["type","text",1,"form-control","form-control-sm","w-4rem",3,"ngModelChange","ngModel"],["type","text",1,"form-control","form-control-sm","w-7rem",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-around"],["type","button",1,"btn","btn-sm","btn-outline-danger","shadow-lg","rounded-5",3,"click"],[1,"bi","bi-trash3-fill"],[1,"d-flex","justify-content-center","align-items-center","h-100"],[1,"d-flex","flex-row","justify-content-around","gap-2"],["type","button",1,"btn","btn-sm","btn-outline-secondary","shadow-lg","rounded-5"],[1,"bi","bi-info-circle-fill","text-primary"],[1,"d-flex","flex-column","justify-content-center","align-items-center","h-100"],["src","assets/images/receipt.png","height","150px","alt","","srcset",""],[2,"font-weight","600"],[2,"color","red","font-weight","600","cursor","pointer",3,"click"],[1,"d-flex","flex-column","p-1","rounded-3","shadow-lg",2,"background-color","#38E54D","color","white"],["type","text","disabled","",1,"form-control","form-control-sm","font-bold",3,"ngModelChange","ngModel"],[1,"mt-2","relative",2,"overflow-y","auto","max-height","80vh"],[1,"card","shadow-lg","border-0","rounded-2","mb-1","rate-charge",2,"position","relative"],[1,"d-flex","flex-row"],[1,"p-2","bg-primary","text-white"],[1,"d-flex","flex-column","pl-2"],[2,"color","red"],[1,"rate-charge-hover-effect",2,"position","absolute","right","0","cursor","pointer"],["src","./../../../../../assets/images/charge_add.png","height","50px","alt","img_not","pTooltip","Add Charge!",3,"click"],[2,"position","relative","height","100vh"],[1,"d-flex","flex-column","p-1"],[1,"m-0","p-0"],[1,"d-flex","flex-row","justify-content-between","align-items-center"],["src","assets/images/info.png","height","30px","alt","","srcset",""],[1,"d-flex","justify-content-between","align-items-center","mt-1"],["optionLabel","label","optionValue","value",3,"onChange","ngModelChange","options","ngModel"],[2,"color","#4C3BCF"],[2,"color","#F97300"],[2,"color","#38E54D"],[1,"p-1",2,"overflow-y","auto","min-height","70dvh","max-height","70dvh","position","relative"],[1,"p-2"],[1,"card","border-0","rounded-3","p-2","shadow-lg",2,"background-color","#DEF5E5"],[1,"d-flex","flex-row","justify-content-between","gap-2"],[1,"d-flex","flex-column","p-2","rounded-3","shadow-lg",2,"background-color","#FDDE55"],[1,"d-flex","flex-column","p-2","rounded-3","shadow-lg",2,"background-color","#5BBCFF"],[1,"d-flex","flex-column","gap-1"],["class","card mb-1 position-relative main-head","style","border: 2px solid #00A9FF;",4,"ngIf"],[1,"card","mb-1","position-relative","main-head",2,"border","2px solid #00A9FF"],[1,"d-flex","flex-row","align-items-center"],[1,"p-2","h-100",2,"background-color","#00A9FF","color","white"],[1,"d-flex","flex-column","p-1","w-100"],[1,"d-flex","flex-row","justify-content-between","w-100"],[1,"btn-danger","text-white","h-100","p-2","d-flex","align-items-center","sub-head","rounded-1",2,"position","absolute","right","0","top","0",3,"click"],[1,"d-flex","flex-column","justify-content-center","text-center","align-items-center","h-100",2,"min-height","60dvh"],["src","./../../../../../assets/images/charge_add.png","height","100px","alt","","srcset",""],["class","card mb-1 position-relative main-head","style","border: 2px solid #00A9FF;",4,"ngFor","ngForOf"],[1,"d-flex","flex-row","gap-1",2,"color","red"],[1,"bi","bi-currency-rupee"],["src","./../../../../../assets/images/receipt.png","height","100px","alt","","srcset",""],["class","row","style","position: relative;",4,"ngIf"],[1,"row",2,"position","relative"],[1,"bg-white","shadow-2","p-3",2,"position","sticky","top","0%"],[1,"flex","justify-content-between"],[1,"flex","flex-column","text-start"],[1,"flex","flex-column","text-end"],[1,"flex","justify-content-between","mt-2"],[1,"flex","flex-wrap"],["class","col-12",4,"ngIf"],[1,"bg-white","shadow-2","p-3",2,"position","sticky","bottom","-4%"],[1,"d-flex","justify-content-around","rounded-5",2,"border","3px solid #021526"],["for",""],[2,"color","red","font-weight","800"],[2,"color","green","font-weight","800"],[2,"color","purple","font-weight","800"],[2,"color","green"],[2,"color","cornflowerblue"],[2,"color","darkorange"],[1,"flex","justify-content-end","mt-1"],[1,"flex","flex-row","gap-1","btn","btn-sm","btn-secondary","text-white","rounded-3",3,"click"],[1,"col-12"],["class","w-100",4,"ngFor","ngForOf"],[1,"w-100"],[1,"flex","flex-row","gap-1","w-100","mb-1","rounded-3","p-2",2,"border","2px solid black"],[1,""],[1,"flex","flex-column","w-100"],[1,"flex","justify-content-between","w-100"],[1,"row"],[1,"flex","flex-column"],[1,"border-round","p-3"],[1,"flex","align-items-center","gap-2","mt-3"],["type","button",1,"btn","btn-sm","btn-danger",3,"click"]],template:function(r,t){if(r&1){let a=B();y(0,vt,134,34,"ng-container",4)(1,At,68,16,"ng-container",4)(2,Wt,2,1,"ng-container",4),i(3,"p-dialog",5),b("visibleChange",function(u){return m(a),x(t.moreDetails,u)||(t.moreDetails=u),p(u)}),y(4,Ft,110,23,"div",6),n(),i(5,"p-dialog",7),b("visibleChange",function(u){return m(a),x(t.billChargesPopup,u)||(t.billChargesPopup=u),p(u)}),i(6,"div",8)(7,"div",9)(8,"small")(9,"strong"),l(10,"Rate Type"),n()(),i(11,"select",10),b("ngModelChange",function(u){return m(a),x(t.selectedRateType,u)||(t.selectedRateType=u),p(u)}),i(12,"option",11),l(13,"Select Type..."),n(),y(14,Ut,3,4,"option",12),n()(),i(15,"div",9)(16,"small")(17,"strong"),l(18,"Sub Type"),n()(),i(19,"select",10),b("ngModelChange",function(u){return m(a),x(t.selectedRateSubType,u)||(t.selectedRateSubType=u),p(u)}),i(20,"option",11),l(21,"Select Sub Type..."),n(),y(22,Ot,3,4,"option",12),n()()(),i(23,"div",13),v(24,"input",14),i(25,"button",15),l(26,"Search"),n()(),i(27,"div",16)(28,"div",17)(29,"strong"),l(30),n()(),y(31,jt,17,5,"div",18),n()(),i(32,"p-confirmPopup",null,0),y(34,Ht,8,1,"ng-template",19),n(),i(35,"p-overlayPanel",null,1)(37,"div",20)(38,"div",8)(39,"div",21)(40,"strong")(41,"small"),l(42,"Unit"),n()(),i(43,"input",22),b("ngModelChange",function(u){return m(a),x(t.billItemCharge.Unit,u)||(t.billItemCharge.Unit=u),p(u)}),C("keyup",function(){return m(a),p(t.calculateFinalRateAmount())}),n()(),i(44,"div",21)(45,"strong")(46,"small"),l(47,"Rate (Per Unit)"),n()(),i(48,"input",22),b("ngModelChange",function(u){return m(a),x(t.billItemCharge.Rate,u)||(t.billItemCharge.Rate=u),p(u)}),C("keyup",function(){return m(a),p(t.calculateFinalRateAmount())}),n()()(),i(49,"div",8)(50,"div",9)(51,"strong")(52,"small"),l(53,"Notes"),n()(),i(54,"textarea",23),b("ngModelChange",function(u){return m(a),x(t.billItemCharge.Notes,u)||(t.billItemCharge.Notes=u),p(u)}),n()(),i(55,"div",9)(56,"div",21)(57,"strong")(58,"small"),l(59,"Final Rate"),n()(),i(60,"input",24),b("ngModelChange",function(u){return m(a),x(t.billItemCharge.Amount,u)||(t.billItemCharge.Amount=u),p(u)}),n()(),i(61,"div",25)(62,"button",26),C("click",function(){return m(a),p(t.saveBillItem())}),l(63,"Add"),n(),i(64,"button",27),C("click",function(){m(a);let u=P(36);return p(u.hide())}),l(65,"Cancel"),n()()()()()(),i(66,"p-overlayPanel",null,2)(68,"div",20)(69,"div",8)(70,"div",21)(71,"strong")(72,"small"),l(73,"Reason for delete?"),n()(),i(74,"input",28),b("ngModelChange",function(u){return m(a),x(t.reasonForDeleteBillItemDetail,u)||(t.reasonForDeleteBillItemDetail=u),p(u)}),n()()(),i(75,"div",25)(76,"button",29),C("click",function(){return m(a),p(t.deleteEntryByBillReceipt())}),l(77,"Delete"),n(),i(78,"button",30),C("click",function(){m(a);let u=P(67);return p(u.hide())}),l(79,"Cancel"),n()()()()}r&2&&(g("ngIf",t.validPlatform("mac")||t.validPlatform("window")),o(),g("ngIf",t.validPlatform("iphone")||t.validPlatform("ipad")||t.validPlatform("andriod")),o(),g("ngIf",!1),o(),A(Y(26,ze)),g("modal",!0),f("visible",t.moreDetails),o(),g("ngIf",t.patientDetail.EntityId>0),o(),A(Y(27,$e)),g("modal",!0),f("visible",t.billChargesPopup),o(6),f("ngModel",t.selectedRateType),g("disabled",!t.rateTypeList.length),o(3),g("ngForOf",t.rateTypeList),o(5),f("ngModel",t.selectedRateSubType),g("disabled",!t.rateSubTypeList.length),o(3),g("ngForOf",t.rateSubTypeList),o(8),D("Charges List (",t.rateList.length,")"),o(),g("ngForOf",t.rateList),o(12),f("ngModel",t.billItemCharge.Unit),o(5),f("ngModel",t.billItemCharge.Rate),o(6),f("ngModel",t.billItemCharge.Notes),o(6),f("ngModel",t.billItemCharge.Amount),o(14),f("ngModel",t.reasonForDeleteBillItemDetail),o(2),g("disabled",t.selectedDeletingBillItemId===0&&!t.reasonForDeleteBillItemDetail.length))},dependencies:[ae,Ce,X,z,ve,Se,le,oe,we,$,xe,F,G,ie,ne,O,te,j,H],styles:[".sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0%}[_nghost-%COMP%]     .p-button{padding:.3rem!important}.font-bold[_ngcontent-%COMP%]{font-weight:800;font-size:1.5rem}.rate-charge-hover-effect[_ngcontent-%COMP%]{display:none}.rate-charge[_ngcontent-%COMP%]:hover   .rate-charge-hover-effect[_ngcontent-%COMP%]{display:block!important}"]})}}return s})();export{ce as a,wi as b};
